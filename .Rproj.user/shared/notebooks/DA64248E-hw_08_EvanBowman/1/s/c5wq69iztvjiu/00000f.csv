"0","tidyBook <- function(bookDF) {"
"0","  stopifnot(is.data.frame(bookDF))"
"0","  "
"0","  bookDF %>%"
"0","    mutate(linenumber = row_number(),"
"0","         chapter = cumsum(str_detect(text,"
"0","                                     regex(""(^chapter [\\divxlc]|^_(?!Contents)(?!Note)[:alpha:]+-?[:alpha:]*_$)"","
"0","                                           ignore_case = TRUE))),"
"0","         .before = text) %>%"
"0","    unnest_tokens(word, text) %>% "
"0","    select(-gutenberg_id) %>%"
"0","    mutate(word = str_extract(word, ""[a-z']+"")) %>%"
"0","    anti_join(stop_words, by = ""word"") %>%"
"0","    filter(!is.na(word), chapter !=0)"
"0","}"
